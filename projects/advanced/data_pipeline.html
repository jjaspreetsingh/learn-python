<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project: Data Pipeline | Learn Python</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@400;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../styles.css">
    <script src="../../script.js" defer></script>
</head>

<body>

    <header>
        <div class="container">
            <nav>
                <div class="logo">Learn Python</div>
                <div class="nav-links">
                    <a href="../../index.html#basics">Basics</a>
                    <a href="../../index.html#intermediate">Intermediate</a>
                    <a href="../../index.html#projects">Projects</a>
                    <a href="../../index.html#resources">Resources</a>
                </div>
            </nav>
        </div>
    </header>

    <div class="doc-wrapper">
        <aside class="doc-sidebar">
            <h3>Advanced Projects</h3>
            <a href="web_scraper.html">Web Scraper</a>
            <a href="rest_api.html">REST API</a>
            <a href="chat_app.html">Chat App</a>
            <a href="data_pipeline.html" class="active">Data Pipeline</a>
            <a href="deployment_script.html">Deployment Script</a>
        </aside>

        <main class="doc-content">
            <div class="breadcrumb">
                <a href="../../index.html">Home</a> <span>/</span> Advanced <span>/</span> Data Pipeline
            </div>

            <h1>Project: Data Pipeline (ETL)</h1>
            <p><strong>ETL</strong> stands for <strong>Extract, Transform, Load</strong>. It's how companies move data
                from A to B while cleaning it up.</p>

            <h2>1. The Concept</h2>
            <ol>
                <li><strong>Extract</strong>: Read data from CSVs, APIs, or Databases.</li>
                <li><strong>Transform</strong>: Clean, filter, and calculate new values.</li>
                <li><strong>Load</strong>: Save the clean data to a final database.</li>
            </ol>

            <h2>2. The Code</h2>
            <p>We'll use `pandas` for processing and `sqlite3` for storage.</p>

            <pre><code class="language-python">import pandas as pd
import sqlite3

def etl_process():
    # 1. Extract
    print("Extracting data...")
    try:
        data = pd.read_csv('raw_sales.csv')
    except FileNotFoundError:
        print("Error: raw_sales.csv not found. Creating dummy data.")
        data = pd.DataFrame({
            'product': ['Apple', 'Banana', 'Orange', 'Apple', None],
            'price': [1.2, 0.5, 0.8, 1.2, 0.0],
            'quantity': [10, 20, 15, 5, 0]
        })

    # 2. Transform
    print("Transforming data...")
    # Remove rows with missing data
    clean_data = data.dropna()
    
    # Calculate Total Sales
    clean_data['total_sales'] = clean_data['price'] * clean_data['quantity']
    
    # Group by Product
    summary = clean_data.groupby('product')['total_sales'].sum().reset_index()
    print("Cleaned Data Preview:")
    print(summary)

    # 3. Load
    print("Loading to Database...")
    conn = sqlite3.connect('warehouse.db')
    summary.to_sql('sales_summary', conn, if_exists='replace', index=False)
    conn.close()
    print("Success! Data loaded to warehouse.db")

if __name__ == "__main__":
    etl_process()</code></pre>

            <div class="card" style="border-left: 4px solid #10b981; background: rgba(16, 185, 129, 0.1);">
                <p style="margin:0; color: #ecfdf5;"><strong>Pro Tip:</strong> In the real world, tools like Airflow or
                    Prefect run these scripts automatically every night.</p>
            </div>

            <h2>3. Challenge</h2>
            <p>Add a logging step. Use Python's `logging` module to save a file named `pipeline.log` that records when
                the script started and finished.</p>

            <div class="page-nav-links">
                <a href="chat_app.html" class="page-nav-link">
                    <small>Previous Project</small>
                    <span>Chat App</span>
                </a>
                <a href="deployment_script.html" class="page-nav-link"
                    style="text-align: right; align-items: flex-end;">
                    <small>Final Project</small>
                    <span>Deployment Script â†’</span>
                </a>
            </div>

        </main>
    </div>

    <footer>
        <div class="container" style="text-align: center;">
            <p>&copy; 2025 Learn Python</p>
        </div>
    </footer>

</body>

</html>